(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{215:function(e,t,r){e.exports=r(268)},268:function(e,t,r){"use strict";r.r(t);var n=r(281),o=r(5),a=r.n(o),c=r(54),i=r.n(c),s=r(31),u=r.n(s);function l(e){return{title:e.title,author:e.author,lines:e.lines,lineCount:parseInt(e.linecount,10)}}var d=r(119),f="https://poetrydb.org/";function j(){return(j=i()(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(f+"random",{method:"GET"});case 2:if(!(t=e.sent).ok){e.next=9;break}return e.next=6,t.json();case 6:if((r=e.sent).status){e.next=9;break}return e.abrupt("return",r);case 9:throw t;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return h.apply(this,arguments)}function h(){return(h=i()(u.a.mark((function e(t,r){var n,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===r&&(r=!1),e.next=3,fetch(f+"title/"+encodeURIComponent(t)+(r?":abs":""),{method:"GET"});case 3:if(!(n=e.sent).ok){e.next=10;break}return e.next=7,n.json();case 7:if((o=e.sent).status){e.next=10;break}return e.abrupt("return",o);case 10:throw n;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return O.apply(this,arguments)}function O(){return(O=i()(u.a.mark((function e(t){var r,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(f+"author/"+encodeURIComponent(t)),e.next=3,fetch(f+"author/"+encodeURIComponent(t),{method:"GET"});case 3:if(!(r=e.sent).ok){e.next=10;break}return e.next=7,r.json();case 7:if((n=e.sent).status){e.next=10;break}return e.abrupt("return",n);case 10:throw r;case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return(m=i()(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([b(t).catch((function(){return[]})),p(t).catch((function(){return[]}))]).then((function(e){var r=e[0],n=e[1];return console.log("poems2",n),r.forEach((function(e){return e.similarity=Object(d.compareTwoStrings)(e.title,t)})),n.map((function(e){return e.similarity=Object(d.compareTwoStrings)(e.author,t)})),[].concat(r,n).sort((function(e,t){var r,n;return(null!=(r=t.similarity)?r:0)-(null!=(n=e.similarity)?n:0)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var g,k={getPoemOfTheDay:function(){return j.apply(this,arguments)},getPoemsWithTitle:b,getPoemsWithAuthor:p,searchPoems:function(e){return m.apply(this,arguments)}},v=r(41),y=r(100),x=Object(v.b)("search/fetchStatus",function(){var e=i()(u.a.mark((function e(t,r){var n,o,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.searchQuery,o=r.rejectWithValue,e.prev=2,console.log("searchQuery",n),e.next=6,k.searchPoems(n);case 6:return a=e.sent,e.abrupt("return",a.map(l));case 10:return e.prev=10,e.t0=e.catch(2),e.abrupt("return",o({error:e.t0}));case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,r){return e.apply(this,arguments)}}()),S=Object(v.c)(),P=S.getInitialState({loadingStatus:"not loaded",error:void 0}),w=Object(v.d)({name:"search",initialState:P,reducers:{},extraReducers:function(e){e.addCase(x.pending,(function(e){e.loadingStatus="loading"})).addCase(x.fulfilled,(function(e,t){S.setAll(e,t.payload.map((function(e){return{id:encodeURIComponent(e.title),poem:e}}))),e.loadingStatus="loaded"})).addCase(x.rejected,(function(e,t){e.loadingStatus="error",e.error=t.error.message}))}}),D=w.reducer,T=(w.actions,S.getSelectors()),B=T.selectAll,E=T.selectEntities,C=T.selectById,I=function(e){return e.search},R=Object(y.a)(I,B),A=Object(y.a)(I,E),M=Object(y.a)(I,(function(e){return e.loadingStatus})),N={getSearchState:I,selectAllSearchResults:R,selectSearchEntities:A,selectSearchResultById:function(e){return Object(y.a)(I,(function(t){return C(t,e)}))},getLoadingStatus:M},L=Object(v.b)("bookmarks/fetchStatus",function(){var e=i()(u.a.mark((function e(t,r){var n,o,a,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.title,o=t.author,a=r.rejectWithValue,e.prev=2,e.next=5,k.getPoemsWithTitle(n,!0);case 5:if((c=e.sent).length){e.next=8;break}return e.abrupt("return",a({error:"not found"}));case 8:if(!(c.length>1)){e.next=13;break}if(i=c.find((function(e){return e.author===o}))){e.next=12;break}return e.abrupt("return",a({error:"not found"}));case 12:return e.abrupt("return",l(i));case 13:return e.abrupt("return",l(c[0]));case 16:return e.prev=16,e.t0=e.catch(2),e.abrupt("return",a({error:e.t0}));case 19:case"end":return e.stop()}}),e,null,[[2,16]])})));return function(t,r){return e.apply(this,arguments)}}()),U=Object(v.c)(),z=U.getInitialState({loadingStatus:"not loaded",error:void 0}),J=Object(v.d)({name:"bookmarks",initialState:z,reducers:{add:U.addOne,remove:U.removeOne},extraReducers:function(e){e.addCase(L.pending,(function(e){e.loadingStatus="loading"})).addCase(L.fulfilled,(function(e,t){e.poem=t.payload,e.loadingStatus="loaded"})).addCase(L.rejected,(function(e,t){e.loadingStatus="error",e.error=t.error.message}))}}),W=J.reducer,V=J.actions,F=U.getSelectors(),G=F.selectAll,Q=F.selectEntities,q=function(e){return e.bookmarks},H={selectAllBookmarks:Object(y.a)(q,G),selectBookmarksEntities:Object(y.a)(q,Q),getBookmarkPoem:Object(y.a)(q,(function(e){return e.poem}))},K=Object(v.b)("poemOfTheDay/fetchStatus",function(){var e=i()(u.a.mark((function e(t,r){var n,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.rejectWithValue,e.prev=1,e.next=4,k.getPoemOfTheDay();case 4:return o=e.sent,e.abrupt("return",l(o[0]));case 8:return e.prev=8,e.t0=e.catch(1),e.abrupt("return",n({error:e.t0}));case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,r){return e.apply(this,arguments)}}()),X={loadingStatus:"not loaded",poem:void 0,error:void 0},Y=Object(v.d)({name:"poemOfTheDay",initialState:X,reducers:{},extraReducers:function(e){e.addCase(K.pending,(function(e){e.loadingStatus="loading"})).addCase(K.fulfilled,(function(e,t){e.poem=t.payload,e.loadingStatus="loaded"})).addCase(K.rejected,(function(e,t){e.loadingStatus="error",e.error=t.error.message}))}}),Z=Y.reducer,$=(Y.actions,function(e){return e.poemOfTheDay}),_={getPoemOfTheDayState:$,getPoemOfTheDay:Object(y.a)($,(function(e){return e.poem})),getPoemOfTheDayLoadingStatus:Object(y.a)($,(function(e){return e.loadingStatus}))},ee=(r(147),r(87)),te={poemOfTheDay:X,bookmarks:z,search:P},re=r(40),ne=r(190),oe=function(e,t){var r=function(e){return Object(re.b)({router:Object(ne.a)(e),poemOfTheDay:Z,bookmarks:W,search:D})}(t),n=Object(ee.b)(e,r),o=Object(v.a)({reducer:n,middleware:function(e){var t=e({serializableCheck:!1});return t},devTools:!1,preloadedState:te});return{store:o,persistor:Object(ee.c)(o)}},ae=Object(ee.a)((function(e){return Object.assign({},e,{ids:JSON.stringify(e.ids),entities:JSON.stringify(e.entities)})}),(function(e){return Object.assign({},e,{ids:JSON.parse(e.ids),entities:JSON.parse(e.entities)})}),{whitelist:["bookmarks"]}),ce=r(191),ie=r(278),se=r(280),ue=r(184),le=r(0),de=r.n(le),fe=r(63),je=r(145),be=r(82),he=r(50),pe=r(151),Oe=r(48),me=r(279);!function(e){e.PoemOfTheDay="Poem of the Day",e.Bookmarks="Bookmarks",e.Bookmark="Bookmark",e.Search="Search",e.Result="Result"}(g||(g={}));var ge=r(8),ke=r.n(ge),ve=r(69),ye=r(45),xe=r(144),Se=r(95),Pe=r(139),we=r(141),De=r(142),Te=r(1),Be=r(2),Ee=r(4),Ce=function(e){var t=e.children;return Object(Ee.jsx)(Be.a,{style:Ie.center,children:t})},Ie=Te.a.create({center:{display:"flex",alignItems:"center",justifyContent:"center"}}),Re=Ce,Ae=Te.a.create({container:{flex:1,justifyContent:"space-between"}}),Me=function(e){var t=e.children;return Object(Ee.jsx)(Be.a,{style:Ae.container,children:t})},Ne=r(38),Le=r(140),Ue=r(93),ze=Te.a.create({spacing:{margin:10}}),Je=function(e){var t=e.children;return Object(Ee.jsx)(Be.a,{style:ze.spacing,children:t})};var We=function(){return Object(Ee.jsx)(Re,{children:Object(Ee.jsx)(Je,{children:Object(Ee.jsx)(Ue.a,{animating:!0,size:"large",children:void 0})})})};var Ve=function(e){var t=e.showLoading,r=e.hasError,n=e.reload,o=e.children;return t?Object(Ee.jsx)(We,{}):r?Object(Ee.jsxs)(Ce,{children:[Object(Ee.jsx)(Je,{children:Object(Ee.jsx)(Ne.a.Icon,{size:40,icon:"alert-circle",children:void 0})}),Object(Ee.jsx)(Pe.a,{children:"Oops~ Something went wrong"}),Object(Ee.jsx)(Le.a,{children:"Make sure you got internet connection."}),n&&Object(Ee.jsx)(Se.a,{onPress:n,mode:"contained",children:"Try Again"})]}):Object(Ee.jsx)(Ee.Fragment,{children:o})};function Fe(e){var t,r,n,o=e.loadingStatus,a=e.formattedDate,c=e.poem,i=e.bookmark,s=e.fetch,u=e.goToSearch,l=Object(Oe.k)(),d=Object(le.useState)(!1),f=ke()(d,2),j=f[0],b=f[1];return Object(Ee.jsxs)(Me,{children:[Object(Ee.jsx)(ve.a,{children:Object(Ee.jsx)(ye.a,{contentInsetAdjustmentBehavior:"automatic",children:Object(Ee.jsx)(Ve,{showLoading:"not loaded"===o||"loading"===o,hasError:"error"===o,reload:s,children:Object(Ee.jsxs)(xe.a,{children:[Object(Ee.jsx)(xe.a.Title,{title:null==c?void 0:c.title,subtitle:a,children:void 0}),Object(Ee.jsx)(xe.a.Cover,{source:{uri:"https://picsum.photos/300/200"}}),Object(Ee.jsxs)(xe.a.Actions,{children:[Object(Ee.jsx)(Se.a,{icon:"heart-plus",onPress:function(){c&&(i(a,c),b(!0))},children:"Bookmark"}),s&&Object(Ee.jsx)(Se.a,{icon:"skip-next",onPress:function(){return s()},children:"Next"}),u&&Object(Ee.jsx)(Se.a,{icon:"magnify",onPress:function(){return u("")},children:"Search"})]}),Object(Ee.jsxs)(xe.a.Content,{children:[Object(Ee.jsxs)(Re,{children:[Object(Ee.jsx)(Pe.a,{children:null==c?void 0:c.title}),null==c||null==(t=c.author)||null==(r=t.split(","))?void 0:r.map((function(e,t){return Object(Ee.jsx)(Se.a,{onPress:function(){return u(e)},children:e},t)}))]}),Object(Ee.jsx)(we.a,{children:null==c||null==(n=c.lines)?void 0:n.map((function(e){return e+"\n"}))})]})]})})})}),Object(Ee.jsx)(De.a,{visible:j,onDismiss:function(){return b(!1)},duration:5e3,action:{label:"View All",onPress:function(){return l.navigate(g.Bookmarks)}},children:"Poem bookmarked!"})]})}function Ge(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Qe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ge(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var qe=Object(he.b)((function(e){return{poem:H.getBookmarkPoem(e)}}),(function(e){return{fetchBookmark:function(t,r){e(L({title:t,author:r}))},bookmark:function(t,r){e(V.add({formattedDate:t,id:encodeURIComponent(r.title),poem:Qe(Qe({},r),{},{lines:r.lines.slice(0,1)})}))}}}))((function(e){var t,r,n,o=e.poem,a=e.fetchBookmark,c=e.bookmark,i=new Date,s=Object(Oe.k)(),u=Object(Oe.m)(),l=null==(t=u.params)?void 0:t.title,d=null==(r=u.params)?void 0:r.author,f=(null==(n=u.params)?void 0:n.formattedDate)||Object(me.a)(i,"MMMM do, yyyy");return Object(le.useEffect)((function(){l&&a(l,d)}),[l,d,a]),Object(Ee.jsx)(Fe,{loadingStatus:"loaded",formattedDate:f,poem:o,bookmark:c,goToSearch:function(e){return s.navigate(g.Search,{search:e})}})})),He=r(143);var Ke=function(e){var t=e.bookmark,r=e.removeBookmark,n=e.onPress;return Object(Ee.jsx)(Ne.c.Item,{title:t.poem.title,descriptionNumberOfLines:3,description:t.formattedDate+"\n"+t.poem.lines[0]+"...",onPress:n,right:function(){return Object(Ee.jsx)(be.a,{size:30,icon:"minus-circle",color:Ne.b.red500,onPress:function(){return r(t)}})}})};var Xe=Object(he.b)((function(e){return{bookmarks:H.selectAllBookmarks(e)}}),(function(e){return{removeBookmark:function(t){e(V.remove(t.id))},addBookmark:function(t){e(V.add(t))}}}))((function(e){var t,r=e.bookmarks,n=e.removeBookmark,o=e.addBookmark,a=Object(Oe.k)(),c=Object(le.useState)(!1),i=ke()(c,2),s=i[0],u=i[1],l=Object(le.useState)(),d=ke()(l,2),f=d[0],j=d[1],b=function(e){n(e),j(e),u(!0)};return Object(Ee.jsxs)(Me,{children:[Object(Ee.jsx)(ve.a,{children:Object(Ee.jsx)(ye.a,{contentInsetAdjustmentBehavior:"automatic",children:r&&null!=r&&r.length?r.map((function(e){return e&&e.poem&&Object(Ee.jsxs)(Be.a,{children:[Object(Ee.jsx)(Ke,{bookmark:e,removeBookmark:b,onPress:function(){return a.navigate(g.Bookmark,{formattedDate:e.formattedDate,title:e.poem.title,author:e.poem.author})}}),Object(Ee.jsx)(He.a,{})]},e.id)})):Object(Ee.jsxs)(Re,{children:[Object(Ee.jsx)(Je,{children:Object(Ee.jsx)(Ne.a.Icon,{size:40,icon:"book-multiple",children:void 0})}),Object(Ee.jsx)(Je,{children:Object(Ee.jsx)(Pe.a,{children:"No poems bookmarked~"})})]})})}),Object(Ee.jsxs)(De.a,{visible:s,onDismiss:function(){return u(!1)},action:{label:"Undo",onPress:function(){f&&o(f)}},children:["Remove ",null==f||null==(t=f.poem)?void 0:t.title]})]})}));function Ye(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ze(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ye(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var $e=Object(he.b)((function(e){return{poem:_.getPoemOfTheDay(e),loadingStatus:_.getPoemOfTheDayLoadingStatus(e)}}),(function(e){return{fetchPoemOfTheDay:function(){e(K())},bookmark:function(t,r){e(V.add({formattedDate:t,id:encodeURIComponent(r.title),poem:Ze(Ze({},r),{},{lines:r.lines.slice(0,1)})}))}}}))((function(e){var t=e.poem,r=e.fetchPoemOfTheDay,n=e.bookmark,o=e.loadingStatus,a=new Date,c=Object(me.a)(a,"MMMM do, yyyy"),i=Object(Oe.k)();return Object(le.useEffect)((function(){r()}),[r]),Object(Ee.jsx)(Fe,{fetch:r,loadingStatus:o,formattedDate:c,poem:t,bookmark:n,goToSearch:function(e){return i.navigate(g.Search,{search:e})}})}));function _e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function et(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_e(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var tt=Object(he.b)((function(e){return{searchResultById:function(t){return N.selectSearchResultById(t)(e)}}}),(function(e){return{bookmark:function(t,r){e(V.add({formattedDate:t,id:encodeURIComponent(r.title),poem:et(et({},r),{},{lines:r.lines.slice(0,1)})}))}}}))((function(e){var t,r=e.searchResultById,n=e.bookmark,o=new Date,a=Object(le.useState)(),c=ke()(a,2),i=c[0],s=c[1],u=Object(Oe.k)(),l=null==(t=Object(Oe.m)().params)?void 0:t.id,d=Object(me.a)(o,"MMMM do, yyyy");return Object(le.useEffect)((function(){var e;l&&s(null==(e=r(l))?void 0:e.poem)}),[l,r]),Object(Ee.jsx)(Fe,{loadingStatus:"loaded",formattedDate:d,poem:i,bookmark:n,goToSearch:function(e){return u.navigate(g.Search,{search:e})}})})),rt=r(146);var nt=function(e){var t,r=e.poem,n=e.onPress;return r&&Object(Ee.jsxs)(Ee.Fragment,{children:[Object(Ee.jsx)(Ne.c.Item,{title:r.title,descriptionNumberOfLines:3,description:r.author+"\n"+(null==(t=r.lines)?void 0:t[0]),onPress:n}),Object(Ee.jsx)(He.a,{})]})};var ot=Object(he.b)((function(e){return{searchEntities:N.selectAllSearchResults(e),loadingStatus:N.getLoadingStatus(e)}}),(function(e){return{fetchSearch:function(t){e(x({searchQuery:t}))}}}))((function(e){var t,r=e.searchEntities,n=e.loadingStatus,o=e.fetchSearch,a=Object(Oe.k)(),c=null==(t=Object(Oe.m)().params)?void 0:t.search,i=de.a.useState(""),s=ke()(i,2),u=s[0],l=s[1];Object(le.useEffect)((function(){c&&c.length&&(l(c),o(c))}),[o,c]);var d=function(e){l(e),e&&e.length>3&&o(e)};return Object(Ee.jsx)(ve.a,{children:Object(Ee.jsxs)(ye.a,{contentInsetAdjustmentBehavior:"automatic",children:[Object(Ee.jsx)(rt.a,{placeholder:"Search any poem title or author",onChangeText:d,value:u,children:void 0,autoComplete:void 0}),Object(Ee.jsx)(Ve,{showLoading:"loading"===n,hasError:"error"===n,reload:function(){return d(u)},children:u&&u.length>3?r&&r.length?r.map((function(e){return Object(Ee.jsx)(nt,{poem:e.poem,onPress:function(){return a.navigate(g.Result,{id:e.id})}},e.id)})):Object(Ee.jsxs)(Re,{children:[Object(Ee.jsx)(Je,{children:Object(Ee.jsx)(Ne.a.Icon,{size:40,icon:"alert-circle",children:void 0})}),Object(Ee.jsx)(Pe.a,{children:"Nothing found~"})]}):Object(Ee.jsx)(Ee.Fragment,{})})]})})}));function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach((function(t){a()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var it=function(){var e={key:"root",storage:ce.a,whitelist:["bookmarks"],transforms:[ae]},t=Object(ue.a)(),r=oe(e,t),n=r.store,o=r.persistor,a=ct(ct({},fe.a),{},{roundness:2,colors:ct(ct({},fe.a.colors),{},{primary:"#855913",accent:"#aec5c5"})}),c=Object(se.a)();return Object(Ee.jsx)(je.a,{theme:a,children:Object(Ee.jsx)(pe.a,{loading:Object(Ee.jsx)(We,{}),persistor:o,children:Object(Ee.jsx)(he.a,{store:n,children:Object(Ee.jsx)(ie.a,{children:Object(Ee.jsxs)(c.Navigator,{initialRouteName:g.PoemOfTheDay,children:[Object(Ee.jsx)(c.Screen,{name:g.PoemOfTheDay,component:$e,options:function(e){var t=e.navigation;return{headerRight:function(){return Object(Ee.jsx)(be.a,{icon:"bookmark",onPress:function(){return t.navigate(g.Bookmarks)}})}}}}),Object(Ee.jsx)(c.Screen,{name:g.Bookmarks,component:Xe}),Object(Ee.jsx)(c.Screen,{name:g.Search,component:ot}),Object(Ee.jsx)(c.Screen,{name:g.Result,component:tt}),Object(Ee.jsx)(c.Screen,{name:g.Bookmark,component:qe})]})})})})})};Object(n.a)(it)}},[[215,1,2]]]);
//# sourceMappingURL=app.b4e3b8f6.chunk.js.map